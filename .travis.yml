language: node_js
before_install:
  # - sudo apt-get install -y wget
  - echo $PATH
  - wget -qO- https://github.com/openshift/origin/releases/download/v3.11.0/openshift-origin-client-tools-v3.11.0-0cbc58b-linux-64bit.tar.gz | tar xvz - -C /tmp/openshift
  # - sudo apt-get install ruby-full rubygems-integration git-core
  # - sudo gem install rhc
install:
  - npm ci
script:
  - npm run lint
  - npm run unit
  - bash infrastructure/build.bash
branches:
  except:
    - master
services:
  - docker
after_success:
  - docker login -u $DOCKER_USER -p $DOCKER_PASS
  - export REPO=jobtechswe/myskills-api
  - export TAG="latest"
  - docker build -f Dockerfile -t $REPO:$TAG .
  - docker push $REPO:$TAG
env:
  global:
    - secure: DOYKVqaObpLYa7iaEPykCuHdXeUw2pHnSZL/6fylLKHDsCoMfvFvW939ubEQebsaeU4HHLMVJ0FT6gpQCRRNnxkp+BPypQMUnkcV6OzAKXoM7OSoaq2RzbAXMQXvaF5Jd82j2d3j1Dx2DF0bGdv5KTxNaqL4hqW1u0z7FIpD7EiTazC2NzSVharpp074t5vsTBBor24GY2QXJ9449gILP0Qw8/JImybmBJ5TtINyREWC+xmTkmjYG+i8zdQxLRW1nKIiWnH82ZwrJtrWS6DI1O1ZOtcCnSlPhlSxVLYgvk76BZr3rNrdgRs7QQ9nAI0XOzc+ao5+3PBy+pGIBGF8CO98qvQfRbDI24BO3Da0F6Rn9IzHd9zX42xMk5DySBR2CrXgCzoHPb1mor+rM6qsBG8O5zo9+AcK1q3sllzHF3o9hHZKQHB5audvdUehp+I5ryv2EbkcUXquPGRgpSHsvTGrDRLQwM9Jkf65SQbbzN9TpCEu7iZy4ysq/LiRKb+ebppsPR/qNrTXH1IDxTnAeUzpnCxc02v7/DnadfD7dLL9qQ2ue2ksrDOlqk79QeGogNvj6dsUySvIqPYEIF3T52u1M7VElGRNjmzox+9d1XcYcwCnRo0djLyRCn9xwMD3KkZQFhsFLGzKeM2TAW4mmJmsn1Od9QnHRrw0kiwXzvk=
    - secure: R2J3BUD6u6GIqQXBPBTujuQNvC2/4QlxHNtqpJ4mdZ4ZjqrimlAI8mIrgWGtFcYjphfz2peD0py0oThDa99TZMdnWMwFnc5Z36UOc6nU4g+GRWdyuDchjxs+TLZ4wvT8UhghvWZseM7HCI4ha2F4+kxReAEgp6pgN2ia0FOXM+RO6NFdNDkmkqpgJcf1WuqGwAUpn0diSPTFOtwTcLQO0AaPtWkT/rRkqGa+qN0E5EhPmyVFDkUB/O/v5q57XbCDKRhQoBGCgn3QW2GaarXfgLCoUvrUJGg0oi3oM8Gndmup4cRs5h9qKEpxbB9C+Zrerx7J3iClpkCPUc9o2YWPXon3QIBpJSN99txcengaq+zQW72wiuNjxgCDAiMtnBgGve4JJTJDIXNasCA/o3DmspnMnDwXl083HQeGtiK09wNeKpen5suI4AcopATA0jKqPvibNRWVJFiTHbteRk0ZfllTOi5AOu6ww+WhxjDfxupOsf06/VpjMjEF1UIDcM6OXtolF0adcwbT2uaE2uHs6dr9T9uo2TLjEcW4IsSR2ucwQdtRXIAz9AYNe0nQAg87/izC4Ecaqwy4yq/a6zT7Tgnc+/c7OVOtetlchome4EvuDkAbtlZMfx04MQAkJDkgR0Hip//fK1atCVZsIodYoXWQKJCfOwaBdPkuKwKMsmQ=
    - secure: Z9mtme8CKE5xJRNUUIDce3xPNq3tn+bWAweyGo6jOIoJpN8bj/jyU9QntI9OlINAnl4qjc3K/73EKeF+63BGgGTRGejU4gB52om1u/++LNF4//Fi82wnCpH7bAQMASwPeZ4h2GHxvDKYPIMRG16tx/O7w6G0XV4qGXZuQLy9GMPdvgvX7Z4LQayxnuoM6FSJHz5eEPO//6wTZe1bze4laO+BddCxeMd1OAAVzrOCasbEz2G42cTa5Pj23/WsrbtUcbFvK+W3YJQBxNxhcVD7V+gxiYYPrdW4YzB/W/ojRrQLeKZPXDQ8bwfEs3+eoCMPTRRRHYIXTyr4Up7Bn9YND7YYbW/PYBA2WtDAo2zW/f/uCTHTWmB7KtcxE6PZNWytLFgkec+5LsDgZMioUf6l7/iQ2pt2jZ9BaYX+seiUSEPkyHgPfHQwD969T4D+7Ejs3xRgbxlUT76Zgs6CaBQGrQaU1pxqp6NcDjyvCfO0kmSVwsyUJyB0vKbaq0PaH0An3sOJYOTyD0HS8LWIA0dMlbNcp8rzP9tGIDhYaPiqteWD0NxoYb8WKNntqNKw3b4cB9BiHTLnpwqlFkXWxlPHG0980lLS7HQa28qWf0W8ToyhSDrFhJbCD1whq7AtZkin6IuDdI6XDqwXE4E6r5K6/VIeqPo3WJE+T2q6fh6gzJ8=
deploy:
  provider: openshift
  user: raduachim
  password:
    secure: xk6ePhUU+c+Ae5AvJ/UN5zc/Im2XdN/hPTkOTfMa54Vz011g8s8j33TVU67MS7FRW3tdPfB2snnb33byoXfZSNsCdugjaN+Z7Z/Hg0/dDDWP1T+LUCuGqVcjHpya78gf8lIP6k1JffEv1xDAcIoBrMGojte1QY8tztTOb7fqrwdoHM919p1ZC7V9OxxdbpPVAFepqhxpTHYkuJaoMJ4HLkMAUQrV3dwfyqNZswtNh2a7XzPvaB0NYf3B5wilDl+4zUX2gFIvrK/eGoLYZxTEIrbm0cQD+xUy7pHTg6VqPgeUDfCnjik5V3jFpyTliiHYJICGjRWeTXZ1GwjKlp09cNklqHYLmCzQJL9tbFhg+bhpvBLu6FiqBtdYNVXkcTsVtxLXNm+kAYGs/Q0dyWeTa4MTAP/FYz4iRPlF4CjNWIbEKpS5qr7QokzXMSzd+urZbNWz6uD5M7U3bL+nKPch6m75jY8K6ou3pkQLmDlAY7yMv37jj9vV5eG4a0d3tCkLUEt+763vHjrLYAe5Y/MKzmn0unil/kdnYtNnLoyoFJTBkFs2Yk+FOMLneyKGrbCCM7A3j1o2Oaj+RrNOiJ9d3HXvwyVtzx8wbzk1SePgGcoYWhF6lLUe2p/As6A68dS23ffUZj1b0PHBxhrXTwwB4F42MU5S62bLBCyxBwtFurg=
  app: myskills/api-ci
  domain: console.dev.services.jtech.se
  on:
    repo: JobtechSwe/myskills-api
    branch: feat/travis
